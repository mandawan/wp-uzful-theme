(function(e){e.fn.infiniteCarousel=function(){function t(e,t){return(new Array(t+1)).join(e)}return this.each(function(){function l(e){var t=e<a?-1:1,r=Math.abs(a-e),i=o*t*u*r;n.filter(":not(:animated)").animate({scrollLeft:"+="+i},500,function(){if(e==0){n.scrollLeft(o*u*f);e=f}else if(e>f){n.scrollLeft(o*u);e=1}a=e});return!1}var n=e("> div",this).css("overflow-x","hidden"),r=n.find("> ul"),i=r.find("> li"),s=i.filter(":first"),o=s.outerWidth(),u=Math.ceil(n.innerWidth()/o),a=1,f=Math.ceil(i.length/u);console.log(n);if(i.length%u!=0){r.append(t('<li class="empty" />',u-i.length%u));i=r.find("> li")}i.filter(":first").before(i.slice(-u).clone().addClass("cloned"));i.filter(":last").after(i.slice(0,u).clone().addClass("cloned"));i=r.find("> li");n.scrollLeft(o*u);n.after('<a class="arrow back">&lt;</a><a class="arrow forward">&gt;</a>');e("a.back",this).click(function(){return l(a-1)});e("a.forward",this).click(function(){return l(a+1)});e(this).bind("goto",function(e,t){l(t)})})}})(jQuery);